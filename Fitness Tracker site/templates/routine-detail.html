{% extends "layout.html" %}

{% block title %}{{ routine.name }} - Workout Sphere{% endblock %}

{% block content %}
<div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-800">{{ routine.name }}</h1>
    <p class="text-gray-600">{{ routine.description if routine.description else 'No description' }}</p>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold text-gray-800">Exercises</h2>
        </div>
        <div class="p-6">
            {% if routine.exercises %}
            <div class="space-y-4">
                {% for exercise in routine.exercises %}
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="font-medium text-gray-800">{{ exercise.name }}</h3>
                        <p class="text-sm text-gray-600">{{ exercise.duration }} mins</p>
                        <p class="text-xs text-gray-500">Last completed: {{ exercise.last_completed if exercise.last_completed else 'Not completed yet' }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-4">
                <p class="text-gray-600">No exercises in this routine yet.</p>
            </div>
            {% endif %}
        </div>
    </div> -->

    <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200">
            <h2 class="text-xl font-semibold text-gray-800">Exercises</h2>
        </div>
        <div class="p-6">
            <div class="space-y-4">
                {% for workout in routine.workouts %}
                <div class="bg-white p-4 rounded-lg shadow">
                    <h3 class="font-medium text-lg">{{ workout.title }}</h3>
                    <p class="text-gray-600">{{ workout.description }}</p>
                    <p class="text-gray-500 text-sm">Duration: {{ workout.duration }} minutes</p>
                </div>
                {% endfor %}
            </div>
            <h2 class="text-xl font-semibold text-gray-800 mt-8">Timer</h2>
            <div class="text-center">
                <div class="text-5xl font-bold text-gray-800 mb-4" id="timer">
                    {{ routine.total_duration }}:00
                </div>
                <div class="flex justify-center space-x-4">
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded" id="startTimer">
                        Start
                    </button>
                    <button class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded" id="resetTimer">
                        Reset
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Timer functionality similar to workout detail page
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM loaded, initializing timer');
        const timerElement = document.getElementById('timer');
        const startButton = document.getElementById('startTimer');
        const resetButton = document.getElementById('resetTimer');
        
        if (!timerElement || !startButton || !resetButton) {
            console.error('Timer elements not found');
            return;
        }
        
        let totalSeconds = {{ routine.workouts | sum(attribute='duration') * 60 }} || 0;
        let timerInterval;
        
        function updateTimer() {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            timerElement.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }
        
        startButton.addEventListener('click', function() {
            if (!timerInterval) {
                timerInterval = setInterval(function() {
                    if (totalSeconds > 0) {
                        totalSeconds--;
                        updateTimer();
                    } else {
                        clearInterval(timerInterval);
                        timerInterval = null;
                        startButton.textContent = 'Start';
                        return;
                    }
                }, 1000);
                startButton.textContent = 'Pause';
            } else {
                clearInterval(timerInterval);
                timerInterval = null;
                startButton.textContent = 'Start';
                updateTimer();
            }
        });
        
        resetButton.addEventListener('click', function() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            totalSeconds = {{ routine.workouts | sum(attribute='duration') * 60 }} || 0;
            updateTimer();
            startButton.textContent = 'Start';
        });
        
        updateTimer();
    });
</script>
{% endblock %}